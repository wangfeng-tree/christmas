<!DOCTYPE html>
<html lang="zh-CN">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0"/>
<title>Merry Christmas</title>

<!-- è‰ºæœ¯å­—ä½“ -->
<link href="https://fonts.googleapis.com/css2?family=Great+Vibes&display=swap" rel="stylesheet">

<style>
html,body{
    margin:0;
    padding:0;
    background:#000;
    overflow:hidden;
    color:#fff;
    text-align:center;
    font-family:"PingFang SC","Microsoft YaHei",sans-serif;
}
h1{
    margin-top:20px;
    font-size:36px;
    letter-spacing:2px;
}
.name{
    font-family:"Great Vibes","PingFang SC";
    font-size:48px;
    margin-top:10px;
    color:#ffd700;
    text-shadow:0 0 10px #ffd700,0 0 20px #ffae00;
}
.tip{
    position:fixed;
    bottom:20px;
    width:100%;
    font-size:14px;
    opacity:.85;
}
canvas{display:block}
</style>
</head>

<body>

<h1>ğŸ„ Merry Christmas ğŸ„</h1>
<div class="name" id="name"></div>
<canvas id="canvas"></canvas>
<div class="tip">ğŸ¶ ç‚¹å‡»ä»»æ„ä½ç½®ï¼Œç‚¹äº®åœ£è¯æ ‘å¹¶æ’­æ”¾éŸ³ä¹</div>

<audio id="music" preload="auto" loop>
<source src="https://cdn.pixabay.com/download/audio/2022/12/02/audio_4d6a3b3a6d.mp3">
</audio>

<script>
// ===== åå­— =====
const params = new URLSearchParams(location.search);
document.getElementById("name").innerText =
    params.get("name") || "Merry Christmas";

// ===== Canvas åˆå§‹åŒ– =====
const canvas = document.getElementById("canvas");
const ctx = canvas.getContext("2d");

function resize(){
    canvas.width = window.innerWidth;
    canvas.height = window.innerHeight;
}
resize();
window.addEventListener("resize",resize);

// ===== åœ£è¯æ ‘ç¯ï¼ˆæ­£ä¸‰è§’ï¼‰ =====
const lights = [];
const colors = ["#ff4d4d","#ffd700","#4dff4d","#4dd2ff","#ff66ff"];

function buildTree(){
    lights.length = 0;
    const baseY = canvas.height * 0.78;
    const height = canvas.height * 0.55;

    for(let i=0;i<600;i++){
        const t = Math.random();             // 0 é¡¶éƒ¨ â†’ 1 åº•éƒ¨
        const y = baseY - t * height;
        const halfWidth = t * height * 0.45;
        const x = canvas.width/2 + (Math.random()*2-1)*halfWidth;

        lights.push({
            x,y,
            r:Math.random()*2+1,
            a:Math.random(),
            v:Math.random()*0.03+0.01,
            c:colors[Math.floor(Math.random()*colors.length)]
        });
    }
}
buildTree();

// ===== åŠ¨ç”» =====
function draw(){
    ctx.clearRect(0,0,canvas.width,canvas.height);

    lights.forEach(l=>{
        l.a += l.v;
        if(l.a>1 || l.a<0.3) l.v*=-1;

        ctx.globalAlpha = l.a;
        ctx.fillStyle = l.c;
        ctx.beginPath();
        ctx.arc(l.x,l.y,l.r,0,Math.PI*2);
        ctx.fill();
    });

    ctx.globalAlpha = 1;
    requestAnimationFrame(draw);
}
draw();

// ===== å¾®ä¿¡éŸ³ä¹ï¼ˆå¼ºåˆ¶ç‚¹å‡»ï¼‰ =====
let started = false;
document.body.addEventListener("click",()=>{
    if(!started){
        document.getElementById("music").play();
        started = true;
    }
});
</script>

</body>
</html>
